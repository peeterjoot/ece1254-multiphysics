%
% Copyright © 2014 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%\input{../blogpost.tex}
%\renewcommand{\basename}{simpleNortonEquivalents}
%\renewcommand{\dirname}{notes/ece1254/}
%\newcommand{\dateintitle}{}
%\newcommand{\keywords}{}

%\input{../peeter_prologue_print2.tex}
%
%\beginArtNoToc
%
%\generatetitle{Simple Norton equivalents}
%\chapter{Simple Norton equivalents}
\label{chap:simpleNortonEquivalents}
%\section{Motivation}
\index{Norton's theorem}

\Cref{multiphysics:problemSet2a:1} contains a circuit with constant voltage source that makes the associated MNA \index{modified nodal analysis} matrix non-symmetric.  Part \ref{multiphysics:problemSet2a:1a} looks like it is there to provide a hint that this source \( V_{\textrm{s}} \) and its internal resistance \( R_{\textrm{s}} \) can likely be replaced by a constant current source.

Here two voltage source configurations will be compared to a current source configuration, with the assumption that equivalent circuit configurations can be found.

\paragraph{First voltage source configuration}

First consider the source and internal series resistance configuration sketched in \cref{fig:nortonEquivalent:nortonEquivalentFig1}, with a purely resistive load.

%nortonEquivalentFig1
\imageFigure{../../figures/ece1254/first-voltage-source-configuration.pdf}{First voltage source configuration.}{fig:nortonEquivalent:nortonEquivalentFig1}{0.3}

The nodal equations for this system are

\begin{enumerate}
\item \( -i_{\textrm{L}} + (V_1 - V_{\textrm{L}}) Z_{\textrm{s}} = 0 \)
\item \( V_{\textrm{L}} Z_{\textrm{L}} + (V_{\textrm{L}} - V_1) Z_{\textrm{s}} = 0 \)
\item \( V_1 = V_{\textrm{s}} \)
\end{enumerate}

In matrix form these are

\begin{equation}\label{eqn:simpleNortonEquivalents:20}
\begin{bmatrix}
Z_{\textrm{s}} & -Z_{\textrm{s}} & -1 \\
-Z_{\textrm{s}} & Z_{\textrm{s}} + Z_{\textrm{L}} & 0 \\
1 & 0 & 0
\end{bmatrix}
\begin{bmatrix}
V_1 \\
V_{\textrm{L}} \\
i_{\textrm{L}}
\end{bmatrix}
=
\begin{bmatrix}
0 \\
0 \\
V_{\textrm{s}}
\end{bmatrix}
\end{equation}

This has solution

\begin{subequations}
\begin{equation}\label{eqn:simpleNortonEquivalents:40}
V_{\textrm{L}} = V_{\textrm{s}} \frac{ R_{\textrm{L}} }{R_{\textrm{L}} + R_{\textrm{s}}}
\end{equation}
\begin{equation}\label{eqn:simpleNortonEquivalents:100}
i_{\textrm{L}} = \frac{V_{\textrm{s}}}{R_{\textrm{L}} + R_{\textrm{s}}}
\end{equation}
\begin{equation}\label{eqn:simpleNortonEquivalents:120}
V_1 = V_{\textrm{s}}.
\end{equation}
\end{subequations}

\paragraph{Second voltage source configuration}

Now consider the same voltage source, but with the series resistance location flipped as sketched in \cref{fig:nortonEquivalent:nortonEquivalentFig2}.

%nortonEquivalentFig2
\imageFigure{../../figures/ece1254/second-voltage-source-configuration.pdf}{Second voltage source configuration.}{fig:nortonEquivalent:nortonEquivalentFig2}{0.3}

The nodal equations are

\begin{enumerate}
\item \( V_1 Z_{\textrm{s}} + i_{\textrm{L}} = 0 \)
\item \( -i_{\textrm{L}} + V_{\textrm{L}} Z_{\textrm{L}} = 0 \)
\item \( V_{\textrm{L}} - V_1 = V_{\textrm{s}} \)
\end{enumerate}

These have matrix form

\begin{equation}\label{eqn:simpleNortonEquivalents:60}
\begin{bmatrix}
Z_{\textrm{s}} & 0 & 1 \\
0 & Z_{\textrm{L}} & -1  \\
-1 & 1 & 0
\end{bmatrix}
\begin{bmatrix}
V_1 \\
V_{\textrm{L}} \\
i_{\textrm{L}}
\end{bmatrix}
=
\begin{bmatrix}
0 \\
0 \\
V_{\textrm{s}}
\end{bmatrix}
\end{equation}

This configuration has solution

\begin{subequations}
\begin{equation}\label{eqn:simpleNortonEquivalents:50}
V_{\textrm{L}} = V_{\textrm{s}} \frac{ R_{\textrm{L}} }{R_{\textrm{L}} + R_{\textrm{s}}}
\end{equation}
\begin{equation}\label{eqn:simpleNortonEquivalents:180}
i_{\textrm{L}} = \frac{V_{\textrm{s}}}{R_{\textrm{L}} + R_{\textrm{s}}}
\end{equation}
\begin{equation}\label{eqn:simpleNortonEquivalents:200}
V_1 = -V_{\textrm{s}} \frac{ R_{\textrm{s}} }{R_{\textrm{L}} + R_{\textrm{s}}}
\end{equation}
\end{subequations}

Observe that the voltage at the load node and the current through this impedance is the same in both circuit configurations.  The internal node voltage is different in each case, but that has no measurable effect on the external load.

\paragraph{Current configuration}

Now consider a current source and internal parallel resistance as sketched in \cref{fig:nortonEquivalent:nortonEquivalentFig3}.

%nortonEquivalentFig3
\imageFigure{../../figures/ece1254/current-source-configuration.pdf}{Current source configuration.}{fig:nortonEquivalent:nortonEquivalentFig3}{0.3}


There is only one nodal equation for this circuit

\begin{enumerate}
\item \( -I_{\textrm{s}} + V_{\textrm{L}} Z_{\textrm{s}} + V_{\textrm{L}} Z_{\textrm{L}} = 0 \)
\end{enumerate}

The load node voltage and current follows immediately

\begin{subequations}
\begin{equation}\label{eqn:simpleNortonEquivalents:80}
V_{\textrm{L}} = \frac{I_{\textrm{s}}}{Z_{\textrm{L}} + Z_{\textrm{s}}}
\end{equation}
\begin{equation}\label{eqn:simpleNortonEquivalents:140}
i_{\textrm{L}} = V_{\textrm{L}} Z_{\textrm{L}} = \frac{Z_{\textrm{L}} I_{\textrm{s}}}{Z_{\textrm{L}} + Z_{\textrm{s}}}
\end{equation}
\end{subequations}

The goal is to find a value for \( I_{\textrm{L}} \) so that the voltage and currents at the load node match either of the first two voltage source configurations.  It has been assumed that the desired parallel source resistance is the same as the series resistance in the voltage configurations.  That was just a guess, but it ends up working out.

From \cref{eqn:simpleNortonEquivalents:80} and \cref{eqn:simpleNortonEquivalents:40} that equivalent current source can be found from

\begin{equation}\label{eqn:simpleNortonEquivalents:160}
V_{\textrm{L}} = V_{\textrm{s}} \frac{ R_{\textrm{L}} }{R_{\textrm{L}} + R_{\textrm{s}}} = \frac{I_{\textrm{s}}}{Z_{\textrm{L}} + Z_{\textrm{s}}},
\end{equation}

or

\begin{dmath}\label{eqn:simpleNortonEquivalents:220}
I_{\textrm{s}}
=
V_{\textrm{s}} \frac{ R_{\textrm{L}} (Z_{\textrm{L}} + Z_{\textrm{s}})}{R_{\textrm{L}} + R_{\textrm{s}}}
=
\frac{V_{\textrm{s}}}{R_{\textrm{S}}} \frac{ R_{\textrm{s}} R_{\textrm{L}} (Z_{\textrm{L}} + Z_{\textrm{s}})}{R_{\textrm{L}} + R_{\textrm{s}}}
\end{dmath}

%\begin{equation}\label{eqn:simpleNortonEquivalents:240}
\boxedEquation{eqn:simpleNortonEquivalents:240}{
I_{\textrm{s}}
=
\frac{V_{\textrm{s}}}{R_{\textrm{S}}}.
}
%\end{equation}

The load is expected to be the same through the load, and is

\begin{equation}\label{eqn:simpleNortonEquivalents:n}
i_{\textrm{L}} = V_{\textrm{L}} Z_{\textrm{L}} =
= V_{\textrm{s}} \frac{ R_{\textrm{L}} Z_{\textrm{L}} }{R_{\textrm{L}} + R_{\textrm{s}}}
= \frac{ V_{\textrm{s}} }{R_{\textrm{L}} + R_{\textrm{s}}},
\end{equation}

which matches \cref{eqn:simpleNortonEquivalents:100}.

\paragraph{Remarks}

The equivalence of the series voltage source configurations with the parallel current source configuration has been demonstrated with a resistive load.  This is a special case of the more general Norton's theorem, as detailed in \citep{wiki:nortons} and \citep{irwin2007bec} \S 5.1.  Neither of those references prove the theorem.  Norton's theorem allows the equivalent current and resistance to be calculated without actually solving the system.  Using that method, the parallel resistance equivalent follows by summing all the resistances in the source circuit with all the voltage sources shorted.  Shorting the voltage sources in this source circuit results in the same configuration.  It was seen directly in the two voltage source configurations that it did not matter, from the point of view of the external load, which sequence the internal series resistance and the voltage source were placed in did not matter.  That becomes obvious with knowledge of Norton's theorem, since shorting the voltage sources leaves just the single resistor in both cases.

%\EndArticle
